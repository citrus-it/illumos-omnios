#!/sbin/sh
#
# Copyright 2006 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# Licensed under the Academic Free License version 2.1
#

. /lib/svc/share/smf_include.sh

if smf_is_nonglobalzone; then
	echo "$SMF_FMRI is not supported in a local zone"
	smf_method_exit $SMF_EXIT_TEMP_DISABLE "non-global zone"
fi

case "$1" in
'start')
	[ ! -x /usr/lib/hal/hald ] && exit $SMF_EXIT_ERR_CONFIG

	[ ! -d /var/run/hald ] && /usr/bin/mkdir -m 755 /var/run/hald
	[ ! -d /media ] && /usr/bin/mkdir -m 755 /media

	/usr/lib/hal/hald --daemon=yes
	err=$?
	if [ $err -ne 0 ]; then
		echo "hal failed to start: error $err"
		exit $SMF_EXIT_ERR_FATAL
	fi
	;;
*)
	echo "Usage: $0 { start }"
	exit $SMF_EXIT_ERR_FATAL
	;;
esac

exit $SMF_EXIT_OK
