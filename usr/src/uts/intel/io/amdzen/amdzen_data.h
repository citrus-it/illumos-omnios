/*
 * This file and its contents are supplied under the terms of the
 * Common Development and Distribution License ("CDDL"), version 1.0.
 * You may only use this file in accordance with the terms of version
 * 1.0 of the CDDL.
 *
 * A full copy of the text of the CDDL should have accompanied this
 * source.  A copy of the CDDL is also available via the Internet at
 * http://www.illumos.org/license/CDDL.
 */

/*
 * Copyright 2022 Oxide Computer Company
 */

#ifndef _AMDZEN_DATA_H
#define	_AMDZEN_DATA_H

/*
 * This header provides shared definitions for userland and the kernel to get at
 * and manipulate different data sources. In particular, we currently contain
 * information about pins and I/O Mux entries for various AMD sockets and
 * processors.
 */

#include <sys/types.h>
#include <sys/stdint.h>
#include <sys/gpio/zen_gpio.h>

#ifdef __cplusplus
extern "C" {
#endif

/*
 * This represents a list of known distinct signals inside the processor that
 * are relevant to software for use through the I/O mux, GPIOs, and related.
 */
typedef enum {
	SP3_SIGNAL_AGPIO0,
	SP3_SIGNAL_AGPIO1,
	SP3_SIGNAL_AGPIO2,
	SP3_SIGNAL_AGPIO3,
	SP3_SIGNAL_AGPIO4,
	SP3_SIGNAL_AGPIO5,
	SP3_SIGNAL_AGPIO6,
	SP3_SIGNAL_AGPIO9_0,
	SP3_SIGNAL_AGPIO10_0,
	SP3_SIGNAL_AGPIO12,
	SP3_SIGNAL_AGPIO16_0,
	SP3_SIGNAL_AGPIO17_0,
	SP3_SIGNAL_AGPIO19,
	SP3_SIGNAL_AGPIO20,
	SP3_SIGNAL_AGPIO21,
	SP3_SIGNAL_AGPIO22,
	SP3_SIGNAL_AGPIO23_0,
	SP3_SIGNAL_AGPIO76,
	SP3_SIGNAL_AGPIO86,
	SP3_SIGNAL_AGPIO87,
	SP3_SIGNAL_AGPIO88,
	SP3_SIGNAL_AGPIO89,
	SP3_SIGNAL_AGPIO129,
	SP3_SIGNAL_AGPIO139,
	SP3_SIGNAL_AGPIO144,
	SP3_SIGNAL_DEVSLP0,
	SP3_SIGNAL_DEVSLP1,
	SP3_SIGNAL_EGPIO9_1,
	SP3_SIGNAL_EGPIO9_2,
	SP3_SIGNAL_EGPIO9_3,
	SP3_SIGNAL_EGPIO10_1,
	SP3_SIGNAL_EGPIO10_2,
	SP3_SIGNAL_EGPIO10_3,
	SP3_SIGNAL_EGPIO16_1,
	SP3_SIGNAL_EGPIO17_1,
	SP3_SIGNAL_EGPIO23_1,
	SP3_SIGNAL_EGPIO23_2,
	SP3_SIGNAL_EGPIO23_3,
	SP3_SIGNAL_EGPIO26,
	SP3_SIGNAL_EGPIO26_1,
	SP3_SIGNAL_EGPIO26_2,
	SP3_SIGNAL_EGPIO26_3,
	SP3_SIGNAL_EGPIO40_0,
	SP3_SIGNAL_EGPIO40_1,
	SP3_SIGNAL_EGPIO40_2,
	SP3_SIGNAL_EGPIO40_3,
	SP3_SIGNAL_EGPIO42,
	SP3_SIGNAL_EGPIO70,
	SP3_SIGNAL_EGPIO74,
	SP3_SIGNAL_EGPIO75,
	SP3_SIGNAL_EGPIO104,
	SP3_SIGNAL_EGPIO105,
	SP3_SIGNAL_EGPIO106,
	SP3_SIGNAL_EGPIO107,
	SP3_SIGNAL_EGPIO108,
	SP3_SIGNAL_EGPIO109,
	SP3_SIGNAL_EGPIO113,
	SP3_SIGNAL_EGPIO114,
	SP3_SIGNAL_EGPIO117,
	SP3_SIGNAL_EGPIO118,
	SP3_SIGNAL_EGPIO119,
	SP3_SIGNAL_EGPIO120,
	SP3_SIGNAL_EGPIO121,
	SP3_SIGNAL_EGPIO122,
	SP3_SIGNAL_EGPIO133,
	SP3_SIGNAL_EGPIO135,
	SP3_SIGNAL_EGPIO136,
	SP3_SIGNAL_EGPIO137,
	SP3_SIGNAL_EGPIO138,
	SP3_SIGNAL_EGPIO140,
	SP3_SIGNAL_EGPIO141,
	SP3_SIGNAL_EGPIO142,
	SP3_SIGNAL_EGPIO143,
	SP3_SIGNAL_EGPIO145,
	SP3_SIGNAL_EGPIO146,
	SP3_SIGNAL_EGPIO147,
	SP3_SIGNAL_EGPIO148,
	SP3_SIGNAL_EGPIO149,
	SP3_SIGNAL_EGPIO150,
	SP3_SIGNAL_EGPIO151,
	SP3_SIGNAL_EGPIO152,
	SP3_SIGNAL_EMMC_CLK,
	SP3_SIGNAL_EMMC_CMD,
	SP3_SIGNAL_EMMC_DATA0,
	SP3_SIGNAL_EMMC_DATA1,
	SP3_SIGNAL_EMMC_DATA2,
	SP3_SIGNAL_EMMC_DATA3,
	SP3_SIGNAL_EMMC_DATA4,
	SP3_SIGNAL_EMMC_DATA5,
	SP3_SIGNAL_EMMC_DATA6,
	SP3_SIGNAL_EMMC_DATA7,
	SP3_SIGNAL_EMMC_DS,
	SP3_SIGNAL_EMMC_PWR_CTRL,
	SP3_SIGNAL_ESPI_ALERT_L,
	SP3_SIGNAL_ESPI_CLK,
	SP3_SIGNAL_ESPI_CS_L,
	SP3_SIGNAL_ESPI_RESET_L,
	SP3_SIGNAL_ESPI_D0,
	SP3_SIGNAL_ESPI_D1,
	SP3_SIGNAL_ESPI_D2,
	SP3_SIGNAL_ESPI_D3,
	SP3_SIGNAL_GENINT1_L,
	SP3_SIGNAL_I2C0_SCL,
	SP3_SIGNAL_I2C0_SDA,
	SP3_SIGNAL_I2C1_SCL,
	SP3_SIGNAL_I2C1_SDA,
	SP3_SIGNAL_I2C2_SCL,
	SP3_SIGNAL_I2C2_SDA,
	SP3_SIGNAL_I2C3_SCL,
	SP3_SIGNAL_I2C3_SDA,
	SP3_SIGNAL_I2C4_SCL,
	SP3_SIGNAL_I2C4_SDA,
	SP3_SIGNAL_I2C5_SCL,
	SP3_SIGNAL_I2C5_SDA,
	SP3_SIGNAL_KBRST_L,
	SP3_SIGNAL_LAD0,
	SP3_SIGNAL_LAD1,
	SP3_SIGNAL_LAD2,
	SP3_SIGNAL_LAD3,
	SP3_SIGNAL_LDRQ0_L,
	SP3_SIGNAL_LFRAME_L,
	SP3_SIGNAL_LPCCLK0,
	SP3_SIGNAL_LPCCLK1,
	SP3_SIGNAL_LPC_CLKRUN_L,
	SP3_SIGNAL_LPC_PD_L,
	SP3_SIGNAL_LPC_PME_L,
	SP3_SIGNAL_LPC_SMI_L,
	SP3_SIGNAL_NMI_SYNC_FLOOD_L,
	SP3_SIGNAL_PCIE_RST0_L,
	SP3_SIGNAL_PCIE_RST1_L,
	SP3_SIGNAL_PCIE_RST2_L,
	SP3_SIGNAL_PCIE_RST3_L,
	SP3_SIGNAL_PSP_INTR0,
	SP3_SIGNAL_PWRGD_OUT,
	SP3_SIGNAL_PWR_BTN_L,
	SP3_SIGNAL_SCL0,
	SP3_SIGNAL_SDA0,
	SP3_SIGNAL_SCL1,
	SP3_SIGNAL_SDA1,
	SP3_SIGNAL_SERIRQ,
	SP3_SIGNAL_SGPIO0_CLK,
	SP3_SIGNAL_SGPIO0_DATAIN,
	SP3_SIGNAL_SGPIO0_DATAOUT,
	SP3_SIGNAL_SGPIO0_LOAD,
	SP3_SIGNAL_SGPIO1_CLK,
	SP3_SIGNAL_SGPIO1_DATAIN,
	SP3_SIGNAL_SGPIO1_DATAOUT,
	SP3_SIGNAL_SGPIO1_LOAD,
	SP3_SIGNAL_SGPIO2_CLK,
	SP3_SIGNAL_SGPIO2_DATAIN,
	SP3_SIGNAL_SGPIO2_DATAOUT,
	SP3_SIGNAL_SGPIO2_LOAD,
	SP3_SIGNAL_SGPIO3_CLK,
	SP3_SIGNAL_SGPIO3_DATAIN,
	SP3_SIGNAL_SGPIO3_DATAOUT,
	SP3_SIGNAL_SGPIO3_LOAD,
	SP3_SIGNAL_SPI_CLK,
	SP3_SIGNAL_SPI_CS1_L,
	SP3_SIGNAL_SPI_CS2_L,
	SP3_SIGNAL_SPI_DI,
	SP3_SIGNAL_SPI_DO,
	SP3_SIGNAL_SPI_HOLD_L,
	SP3_SIGNAL_SPI_TPM_CS_L,
	SP3_SIGNAL_SYS_RESET_L,
	SP3_SIGNAL_SPI_WP_L,
	SP3_SIGNAL_UART0_CTS_L,
	SP3_SIGNAL_UART0_INTR,
	SP3_SIGNAL_UART0_RTS_L,
	SP3_SIGNAL_UART0_RXD,
	SP3_SIGNAL_UART0_TXD,
	SP3_SIGNAL_UART1_CTS_L,
	SP3_SIGNAL_UART1_INTR,
	SP3_SIGNAL_UART1_RTS_L,
	SP3_SIGNAL_UART1_RXD,
	SP3_SIGNAL_UART1_TXD,
	SP3_SIGNAL_UART2_RXD,
	SP3_SIGNAL_UART2_TXD,
	SP3_SIGNAL_UART3_RXD,
	SP3_SIGNAL_UART3_TXD,
	SP3_SIGNAL_USB_OC0_L,
	SP3_SIGNAL_USB_OC1_L,
	SP3_SIGNAL_USB_OC2_L,
	SP3_SIGNAL_USB_OC3_L,
	SP3_SIGNAL_WAKE_L,
	SP3_SIGNAL_INVALID	= UINT32_MAX
} sp3_signal_t;

typedef enum {
	SP5_SIGNAL_AGPIO0,
	SP5_SIGNAL_AGPIO1,
	SP5_SIGNAL_AGPIO2,
	SP5_SIGNAL_AGPIO3,
	SP5_SIGNAL_AGPIO4,
	SP5_SIGNAL_AGPIO5,
	SP5_SIGNAL_AGPIO6,
	SP5_SIGNAL_AGPIO7,
	SP5_SIGNAL_AGPIO12,
	SP5_SIGNAL_AGPIO13,
	SP5_SIGNAL_AGPIO14,
	SP5_SIGNAL_AGPIO16,
	SP5_SIGNAL_AGPIO17,
	SP5_SIGNAL_AGPIO19,
	SP5_SIGNAL_AGPIO20,
	SP5_SIGNAL_AGPIO21,
	SP5_SIGNAL_AGPIO22,
	SP5_SIGNAL_AGPIO23,
	SP5_SIGNAL_AGPIO24,
	SP5_SIGNAL_AGPIO26,
	SP5_SIGNAL_AGPIO74,
	SP5_SIGNAL_AGPIO75,
	SP5_SIGNAL_AGPIO76,
	SP5_SIGNAL_AGPIO87,
	SP5_SIGNAL_AGPIO88,
	SP5_SIGNAL_AGPIO89,
	SP5_SIGNAL_AGPIO104,
	SP5_SIGNAL_AGPIO105,
	SP5_SIGNAL_AGPIO106,
	SP5_SIGNAL_AGPIO107,
	SP5_SIGNAL_AGPIO108,
	SP5_SIGNAL_AGPIO109,
	SP5_SIGNAL_AGPIO110,
	SP5_SIGNAL_AGPIO115,
	SP5_SIGNAL_AGPIO116,
	SP5_SIGNAL_AGPIO117,
	SP5_SIGNAL_AGPIO118,
	SP5_SIGNAL_AGPIO119,
	SP5_SIGNAL_AGPIO120,
	SP5_SIGNAL_AGPIO121,
	SP5_SIGNAL_AGPIO122,
	SP5_SIGNAL_AGPIO123,
	SP5_SIGNAL_AGPIO124,
	SP5_SIGNAL_AGPIO125,
	SP5_SIGNAL_AGPIO126,
	SP5_SIGNAL_AGPIO129,
	SP5_SIGNAL_AGPIO131,
	SP5_SIGNAL_AGPIO132,
	SP5_SIGNAL_AGPIO133,
	SP5_SIGNAL_AGPIO134,
	SP5_SIGNAL_AGPIO135,
	SP5_SIGNAL_AGPIO136,
	SP5_SIGNAL_AGPIO137,
	SP5_SIGNAL_AGPIO138,
	SP5_SIGNAL_AGPIO139,
	SP5_SIGNAL_AGPIO141,
	SP5_SIGNAL_AGPIO142,
	SP5_SIGNAL_AGPIO145,
	SP5_SIGNAL_AGPIO146,
	SP5_SIGNAL_AGPIO147,
	SP5_SIGNAL_AGPIO148,
	SP5_SIGNAL_AGPIO149,
	SP5_SIGNAL_AGPIO150,
	SP5_SIGNAL_AGPIO151,
	SP5_SIGNAL_AGPIO152,
	SP5_SIGNAL_AGPIO256,
	SP5_SIGNAL_AGPIO257,
	SP5_SIGNAL_AGPIO258,
	SP5_SIGNAL_AGPIO259,
	SP5_SIGNAL_AGPIO260,
	SP5_SIGNAL_AGPIO261,
	SP5_SIGNAL_AGPIO264,
	SP5_SIGNAL_AGPIO265,
	SP5_SIGNAL_AGPIO266,
	SP5_SIGNAL_DEVSLP0,
	SP5_SIGNAL_DEVSLP1,
	SP5_SIGNAL_ESPI_CLK0,
	SP5_SIGNAL_ESPI_CLK1,
	SP5_SIGNAL_ESPI_CLK2,
	SP5_SIGNAL_ESPI_CS0_L,
	SP5_SIGNAL_ESPI_CS1_L,
	SP5_SIGNAL_ESPI_RSTIN_L,
	SP5_SIGNAL_ESPI_RSTOUT_L,
	SP5_SIGNAL_ESPI0_ALERT_D1,
	SP5_SIGNAL_ESPI0_DATA0,
	SP5_SIGNAL_ESPI0_DATA1,
	SP5_SIGNAL_ESPI0_DATA2,
	SP5_SIGNAL_ESPI0_DATA3,
	SP5_SIGNAL_ESPI1_ALERT_D1,
	SP5_SIGNAL_ESPI1_DATA0,
	SP5_SIGNAL_ESPI1_DATA1,
	SP5_SIGNAL_ESPI1_DATA2,
	SP5_SIGNAL_ESPI1_DATA3,
	SP5_SIGNAL_GENINT_L,
	SP5_SIGNAL_I2C0_SCL,
	SP5_SIGNAL_I2C0_SDA,
	SP5_SIGNAL_I2C1_SCL,
	SP5_SIGNAL_I2C1_SDA,
	SP5_SIGNAL_I2C2_SCL,
	SP5_SIGNAL_I2C2_SDA,
	SP5_SIGNAL_I2C3_SCL,
	SP5_SIGNAL_I2C3_SDA,
	SP5_SIGNAL_I2C4_SCL,
	SP5_SIGNAL_I2C4_SDA,
	SP5_SIGNAL_I2C5_SCL,
	SP5_SIGNAL_I2C5_SDA,
	SP5_SIGNAL_I3C0_SCL,
	SP5_SIGNAL_I3C0_SDA,
	SP5_SIGNAL_I3C1_SCL,
	SP5_SIGNAL_I3C1_SDA,
	SP5_SIGNAL_I3C2_SCL,
	SP5_SIGNAL_I3C2_SDA,
	SP5_SIGNAL_I3C3_SCL,
	SP5_SIGNAL_I3C3_SDA,
	SP5_SIGNAL_KBRST_L,
	SP5_SIGNAL_PCIE_RST0_L,
	SP5_SIGNAL_PCIE_RST1_L,
	SP5_SIGNAL_PM_INTR_L,
	SP5_SIGNAL_PWR_BTN_L,
	SP5_SIGNAL_PWRGD_OUT,
	SP5_SIGNAL_SATA_ACT_L,
	SP5_SIGNAL_SD0_CLK,
	SP5_SIGNAL_SD0_CMD,
	SP5_SIGNAL_SGPIO_DATAOUT,
	SP5_SIGNAL_SGPIO_LOAD,
	SP5_SIGNAL_SGPIO0_CLK,
	SP5_SIGNAL_SGPIO1_CLK,
	SP5_SIGNAL_SGPIO2_CLK,
	SP5_SIGNAL_SGPIO3_CLK,
	SP5_SIGNAL_SMBUS0_SCL,
	SP5_SIGNAL_SMBUS0_SDA,
	SP5_SIGNAL_SMBUS1_SCL,
	SP5_SIGNAL_SMBUS1_SDA,
	SP5_SIGNAL_SMERR_L,
	SP5_SIGNAL_SPI_CS0_L,
	SP5_SIGNAL_SPI_CS1_L,
	SP5_SIGNAL_SPI_CS2_L,
	SP5_SIGNAL_SPI_TPM_CS_L,
	SP5_SIGNAL_SYS_RESET_L,
	SP5_SIGNAL_UART0_CTS_L,
	SP5_SIGNAL_UART0_INTR,
	SP5_SIGNAL_UART0_RTS_L,
	SP5_SIGNAL_UART0_RXD_L,
	SP5_SIGNAL_UART0_TXD,
	SP5_SIGNAL_UART1_RXD,
	SP5_SIGNAL_UART1_TXD,
	SP5_SIGNAL_UART2_RXD,
	SP5_SIGNAL_UART2_TXD,
	SP5_SIGNAL_USB00_OC_L,
	SP5_SIGNAL_USB01_OC_L,
	SP5_SIGNAL_USB10_OC_L,
	SP5_SIGNAL_USB11_OC_L,
	SP5_SIGNAL_WAKE_L,
	SP5_SIGNAL_INVALID = UINT32_MAX
} sp5_signal_t;

/*
 * Everything in this section is specific to the kernel portion of the GPIO and
 * I/O mux data. It should not be exposed to user utilities that are trying to
 * understand and display data.
 */
#ifdef	_KERNEL

typedef enum {
	ZEN_PIN_OVR_NONE = 0,
	ZEN_PIN_OVR_SPI,
	ZEN_PIN_OVR_NMI
} zen_pin_ovr_t;

typedef struct {
	const char *zg_name;
	const char *zg_signal;
	const char *zg_pin;
	uint32_t zg_id;
	zen_gpio_cap_t zg_cap;
	zen_gpio_pad_type_t zg_pad;
	zen_gpio_voltage_t zg_voltage;
	zen_pin_ovr_t zg_pinovr;
	uint32_t zg_iomux[4];
	uint32_t zg_override;
} zen_gpio_pindata_t;

extern const zen_gpio_pindata_t *amdzen_data_pininfo(size_t *npins);

#endif	/* _KERNEL */

#ifdef __cplusplus
}
#endif

#endif /* _AMDZEN_DATA_H */
